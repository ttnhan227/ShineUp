@model Client.Models.ResetPasswordViewModel

<div class="login-container">
    <div class="login-box">
        <div class="login-header">
            <h2>Reset Password</h2>
            <p>Enter your new password</p>
        </div>

        <form asp-controller="Auth" asp-action="ResetPassword" method="post" class="login-form">
            <input type="hidden" asp-for="Email" />
            <input type="hidden" asp-for="OTP" />
            <div class="form-group">
                <label asp-for="NewPassword">New Password</label>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input asp-for="NewPassword" class="form-control" type="password" placeholder="Enter new password" required />
                </div>
                <span asp-validation-for="NewPassword" class="text-danger"></span>
            </div>
            <button type="submit" class="btn btn-primary btn-block">Reset Password</button>
        </form>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Success!</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Your password has been reset successfully.</p>
                    <p>You will be redirected to the login page.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="redirectToLogin()">Continue</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Show success modal and redirect
        function showSuccessAndRedirect() {
            const modal = new bootstrap.Modal(document.getElementById('successModal'));
            modal.show();
        }

        function redirectToLogin() {
            window.location.href = '@Url.Action("Login", "Auth")';
        }

        // Show modal if password reset was successful
        if (@Json.Serialize(TempData["PasswordResetSuccess"] ?? false)) {
            showSuccessAndRedirect();
        }
    </script>
}
